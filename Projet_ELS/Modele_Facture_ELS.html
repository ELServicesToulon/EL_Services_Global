<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <title>Modele de facture ELS</title>
  <style>
    :root {
      --primary: #8e44ad;
      /* Violet - Creativity/Wisdom */
      --secondary: #5dade2;
      /* Cyan - Trust/Calm */
      --dark: #2c3e50;
      /* Dark Blue - Professionalism */
      --text: #34495e;
      /* Grey Blue - Readability */
      --bg: #fdfdfd;
      /* Clean White */
      --card-bg: #ffffff;
      --highlight: #f4f6f7;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Montserrat', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      font-size: 11pt;
      line-height: 1.5;
      color: var(--text);
      background: #eee;
    }

    .page {
      width: 210mm;
      min-height: 297mm;
      margin: 0 auto;
      background: var(--card-bg);
      padding: 15mm 15mm 15mm;
      /* Balanced padding */
      position: relative;
    }

    /* UTILS */
    .text-primary {
      color: var(--primary);
    }

    .text-secondary {
      color: var(--secondary);
    }

    .text-dark {
      color: var(--dark);
    }

    .font-bold {
      font-weight: 700;
    }

    .text-uppercase {
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .text-right {
      text-align: right;
    }

    .text-center {
      text-align: center;
    }

    /* HEADER - Split Layout */
    .header-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-bottom: 20px;
      border-bottom: 2px solid var(--highlight);
      margin-bottom: 30px;
    }

    .brand-block {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .brand-logo {
      width: 80px;
      /* Adjust based on actual logo size */
    }

    .brand-text h1 {
      margin: 0;
      font-size: 18pt;
      color: var(--primary);
      line-height: 1.1;
    }

    .brand-text p {
      margin: 4px 0 0;
      font-size: 9pt;
      color: var(--secondary);
      font-weight: 600;
      text-transform: uppercase;
    }

    .company-details {
      text-align: right;
      font-size: 9pt;
      color: #7f8c8d;
    }

    /* TRUST BANNER */
    .trust-banner {
      background: linear-gradient(90deg, rgba(142, 68, 173, 0.05) 0%, rgba(93, 173, 226, 0.1) 100%);
      color: var(--primary);
      text-align: center;
      padding: 8px;
      border-radius: 4px;
      font-size: 10pt;
      font-weight: 600;
      margin-bottom: 30px;
    }

    /* HERO SECTION - Grid Layout */
    .invoice-hero {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 40px;
      margin-bottom: 40px;
    }

    /* Left Column: Client & Info */
    .client-box h3 {
      font-size: 10pt;
      color: var(--secondary);
      text-transform: uppercase;
      margin: 0 0 10px 0;
      border-bottom: 1px solid var(--highlight);
      display: inline-block;
      padding-bottom: 3px;
    }

    .client-name {
      font-size: 14pt;
      font-weight: 700;
      color: var(--dark);
      margin-bottom: 5px;
    }

    .meta-grid {
      display: grid;
      grid-template-columns: auto 1fr;
      gap: 8px 15px;
      margin-top: 20px;
      font-size: 9.5pt;
    }

    .meta-label {
      color: #95a5a6;
    }

    .meta-value {
      color: var(--dark);
      font-weight: 600;
    }

    /* Right Column: The "Payable" Focus */
    .payment-card {
      background: var(--highlight);
      border-radius: 12px;
      padding: 25px;
      text-align: center;
      border: 1px solid #eef2f3;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .payment-label {
      font-size: 11pt;
      color: var(--text);
      margin-bottom: 10px;
    }

    .payment-amount {
      font-size: 28pt;
      font-weight: 800;
      color: var(--primary);
      line-height: 1;
      margin-bottom: 5px;
    }

    .payment-context {
      font-size: 10pt;
      color: #7f8c8d;
    }

    .discount-badge {
      margin-top: 15px;
      display: inline-block;
      background: #fff;
      color: var(--secondary);
      padding: 5px 15px;
      border-radius: 20px;
      font-size: 9pt;
      font-weight: 600;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    }

    /* DETAILS TABLE */
    .details-section h3 {
      font-size: 12pt;
      color: var(--dark);
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .details-section h3::after {
      content: '';
      flex: 1;
      height: 1px;
      background: #ecf0f1;
    }

    /* FOOTER / PAYMENT INFO */
    .footer-grid {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 30px;
      margin-top: auto;
      /* Push to bottom if content is short, usually styled in distinct section */
      padding-top: 30px;
      border-top: 2px solid var(--highlight);
    }

    .payment-info p {
      margin: 3px 0;
      font-size: 9.5pt;
      color: #7f8c8d;
    }

    .payment-info strong {
      color: var(--dark);
    }

    .legal-links {
      text-align: right;
      font-size: 9pt;
    }

    .legal-links a {
      color: var(--secondary);
      text-decoration: none;
      font-weight: 600;
    }

    /* ANNEXE TABLE STYLES */
    table.data {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }

    table.data th {
      text-align: left;
      color: var(--primary);
      font-size: 9pt;
      border-bottom: 2px solid var(--highlight);
      padding: 10px 5px;
    }

    table.data td {
      padding: 12px 5px;
      border-bottom: 1px solid #f0f0f0;
      font-size: 10pt;
    }

    table.data tr:last-child td {
      border-bottom: none;
    }

    .notes {
      color: #95a5a6;
      font-style: italic;
      font-size: 9pt;
    }

    .page-break {
      page-break-before: always;
    }

    @media print {
      body {
        background: white;
      }

      .page {
        margin: 0;
        box-shadow: none;
        padding: 10mm;
      }
    }
  </style>
</head>

<body>
  <!-- PAGE 1: FACTURE -->
  <div class="page">

    <!-- HEADER -->
    <div class="header-container">
      <div class="brand-block">
        <div class="brand-logo">{{logo}}</div>
        <div class="brand-text">
          <h1>{{nom_entreprise}}</h1>
          <p>Bien-&ecirc;tre patient &bull; Excellence officinale</p>
        </div>
      </div>
      <div class="company-details">
        <p>{{adresse_entreprise}}</p>
        <p>SIRET : {{siret}}</p>
        <p>{{email_entreprise}}</p>
        <p style="font-size: 8pt; margin-top: 4px; color: #95a5a6;">Assurance RC Auto-Entrepreneur SIMPLIS n&deg;
          15251070</p>
      </div>
    </div>

    <!-- TRUST BANNER -->
    <div class="trust-banner">
      Une année de confiance s'achève, merci de la vôtre !
    </div>

    <!-- HERO SECTION -->
    <div class="invoice-hero">
      <!-- Client & Invoice Meta -->
      <div>
        <div class="client-box">
          <h3>Destinataire</h3>
          <div class="client-name">{{client_nom}}</div>
          <div style="color: #7f8c8d;">{{client_adresse}}</div>
        </div>

        <div class="meta-grid">
          <span class="meta-label">Num&eacute;ro :</span>
          <span class="meta-value text-primary">{{numero_facture}}</span>

          <span class="meta-label">Date :</span>
          <span class="meta-value">{{date_facture}}</span>

          <span class="meta-label">P&eacute;riode :</span>
          <span class="meta-value">{{periode_facturee}}</span>

          <span class="meta-label">&Eacute;ch&eacute;ance :</span>
          <span class="meta-value">{{date_echeance}}</span>
        </div>
      </div>

      <!-- Payment Highlight -->
      <div class="payment-card">
        <div class="payment-label">Net &agrave; payer</div>
        <div class="payment-amount">{{total_du}} &euro;</div>
        <div class="payment-context">pour {{nombre_courses}} tourn&eacute;es</div>

        <div class="discount-badge">
          2025 {{total_remises_offertes}} 2026
        </div>
      </div>
    </div>

    <!-- PAYMENT & LEGAL -->
    <div class="details-section">
      <h3>Informations de r&egrave;glement</h3>
      <div class="footer-grid">
        <div class="payment-info">
          <p>R&egrave;glement attendu sous <strong>{{delai_paiement}} jours</strong></p>
          <p>Banque : <strong>{{societe_banque}}</strong></p>
          <p>IBAN : {{rib_entreprise}}</p>
          <p>BIC : {{bic_entreprise}}</p>
        </div>
        <div class="legal-links">
          <p>Tarifs &amp; CGV :</p>
          <p>{{lien_tarifs}}</p>
          <p>{{lien_cgv}}</p>
        </div>
      </div>
    </div>

  </div>

  <div class="page-break"></div>

  <!-- PAGE 2: ANNEXE -->
  <div class="page">
    <div class="header-container" style="border:none; margin-bottom: 10px;">
      <div class="brand-block">
        <span class="text-primary font-bold text-uppercase">D&eacute;tail des services</span>
      </div>
      <div class="company-details">
        Ref: {{numero_facture}}
      </div>
    </div>

    <p style="font-size: 9pt; color: #95a5a6; margin-bottom: 20px;">
      Ce document annexe est destin&eacute; &agrave; votre suivi interne.
    </p>

    <table class="data" data-els="bordereau-annexe">
      <thead>
        <tr>
          <th>Date</th>
          <th>Horaire</th>
          <th>D&eacute;tails</th>
          <th>Notes</th>
          <th class="text-right">Montant</th>
        </tr>
      </thead>
      <tbody>
        <? for (var i = 0; i < lignesBordereau.length; i++) { 
             var ligne = lignesBordereau[i];
        ?>
        <tr>
          <td>
            <?= ligne.date ?>
          </td>
          <td>
            <?= ligne.heure ?>
          </td>
          <td>
            <?= ligne.details ?>
            <? if (ligne.remiseMontantTexte) { ?>
            <br><small style="color:var(--secondary)">Remise:
              <?= ligne.remiseMontantTexte ?>
            </small>
            <? } ?>
          </td>
          <td class="notes">
            <? if (ligne.lienNote && ligne.lienNote.startsWith('http')) { ?>
            <a href="<?= ligne.lienNote ?>" target="_blank" style="color:var(--secondary)">Voir la note</a>
            <? } else { ?>
            <?= ligne.note ?>
            <? } ?>
          </td>
          <td class="text-right">
            <?= ligne.montantTexte ?>
            <? if (ligne.estOfferte) { ?>
            <span style="color:var(--secondary)">(Offert)</span>
            <? } else if (ligne.remiseMontantTexte) { ?>
            <span style="color:var(--secondary)"> (-
              <?= ligne.remiseTexte ?>)
            </span>
            <? } ?>
          </td>
        </tr>
        <? } ?>
      </tbody>
    </table>
  </div>
</body>

</html>