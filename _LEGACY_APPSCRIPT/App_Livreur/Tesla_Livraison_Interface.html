<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>
        <?= pageTitle ?>
    </title>
    <?!= includeTemplate('Tesla_Livraison_CSS'); ?>
</head>

<body class="tesla-app tesla-livraison">
    <header class="hero">
        <div class="hero-left">
            <p class="eyebrow">Tesla Livraison</p>
            <h1>Check autonomie & batterie</h1>
            <p class="subtitle">Brief instantane pour les tournees ELS, optimise ecran Tesla + mobile.</p>
        </div>
        <div class="hero-actions">
            <button id="btn-refresh" class="btn primary">Rafraichir</button>
            <button id="btn-force" class="btn ghost">Reveil Tessie</button>
        </div>
    </header>

    <main class="layout">
        <section class="grid">
            <article class="card battery">
                <div class="card-header">
                    <span class="pill">Batterie</span>
                    <span id="status-tag" class="pill pill-muted">--</span>
                </div>
                <div class="battery-level">
                    <span id="battery-level">--</span><span class="unit">%</span>
                </div>
                <div class="battery-bar">
                    <div id="battery-bar-fill"></div>
                </div>
                <p id="battery-threshold" class="hint"></p>
            </article>

            <article class="card range">
                <div class="card-header">
                    <span class="pill">Autonomie estimee</span>
                    <span class="pill pill-muted">Livraisons</span>
                </div>
                <div class="range-value">
                    <span id="range-km">--</span>
                    <span class="unit">km</span>
                </div>
                <p class="hint">Valeur Tessie convertie en km.</p>
            </article>

            <article class="card charge">
                <div class="card-header">
                    <span class="pill">Charge</span>
                    <span id="plug-state" class="pill pill-muted">--</span>
                </div>
                <div class="charge-grid">
                    <div class="metric">
                        <p class="label">Statut</p>
                        <p id="charge-state" class="value">--</p>
                    </div>
                    <div class="metric">
                        <p class="label">Plein dans</p>
                        <p id="minutes-full" class="value">--</p>
                    </div>
                </div>
                <p class="hint">Indique si le cable est detecte et l'estimation Tessie.</p>
            </article>

            <article class="card advice">
                <div class="card-header">
                    <span class="pill">Brief chauffeur</span>
                </div>
                <p id="advice-text" class="advice-text">En attente de donnees Tesla...</p>
                <ul class="meta-list">
                    <li>
                        <span>Derniere mise a jour</span>
                        <strong id="last-update">--</strong>
                    </li>
                    <li>
                        <span>Seuil alerte</span>
                        <strong id="threshold">--%</strong>
                    </li>
                    <li>
                        <span>Source</span>
                        <strong id="source-tag">--</strong>
                    </li>
                </ul>
            </article>
        </section>

        <section class="card deliveries">
            <div class="deliveries-head">
                <div>
                    <p class="pill pill-muted">Livraisons</p>
                    <h2>Courses chauffeur</h2>
                </div>
                <div class="deliveries-actions">
                    <input type="date" id="livreur-date" class="input-compact">
                    <input type="password" id="livreur-code" class="input-compact" placeholder="Code chauffeur">
                    <button id="livreur-save-code" class="btn ghost">Enregistrer</button>
                    <button id="livreur-refresh" class="btn primary">Rafraichir</button>
                </div>
            </div>
            <div class="deliveries-subhead">
                <p class="hint" id="livreur-hint">Saisir le code chauffeur pour charger les courses du jour.</p>
                <div class="status-legend">
                    <span class="status-badge planned">Prévue</span>
                    <span class="status-badge running">En cours</span>
                    <span class="status-badge done">Livrée</span>
                    <span class="status-badge cancel">Annulée</span>
                </div>
            </div>
            <div id="livraisons-liste" class="deliveries-list">
                <p class="hint">Aucune donnée chargée.</p>
            </div>
        </section>
    </main>

    <div id="error-banner" class="error-banner hidden"></div>
    <div id="toast" class="toast hidden"></div>

    <?!= includeTemplate('Tesla_Livraison_JS'); ?>
</body>

</html>